# CH 2.3 네트워크 기기

> 97 page


## TCP/IP 4계층 모델
OSI계층이 좀더 학문적인 느낌이라면, OSI 이론을 실제로 실무에서 사용하는 인터넷 표준이 TCP/IP 4계층이다.

 

*기울임* 계층을 나누는 이유?

통신이 일어나는 과정을 단계별로 파악하기 용이하여, 특정 계층에서 장애 발생하더라도 다른 계층의 장비나 소프트웨어를 건들이는 헛수고를 안할수 있다는 장점.

 

**굵게** TCP/IP 프로토콜

상위 계층 TCP : 메시지나 파일을 좀 더 작은 패킷으로 나누어 전송하고, 받은 패킷은 원래의 메시지로 조립하는 일 담당.

하위 계층 IP : 각 패킷의 주소부분을 처리하여 패킷들이 목적지에 정확하게 도달할 수 있도록함.

 

**굵게** 1. 네트워크 인터페이스 계층

OSI7계층의 물리계층과 데이터링크계층에 해당.

실제로 TCP/IP 패킷을 주고받는 계층이다. 

 

통신시 MAC주소를 사용하며,

수행하는 기능으로는 에러 검출, 패킷의 프레임화 등이 있다.

자세한 특징은 아래 OSI 7계층의 물리,데이터링크 계층에서 각각 설명.

 

프로토콜 종류: Ethernet 등이 있다.

 

**굵게** 2. 인터넷 계층

가장 중요한 기능은 Routing(경로설정: 데이터를 목적지까지 가장 안전하고 빠르게 전달하는 기능)

그외에도 Addressing(IP주소부여), packaging 이 있다.

 

네트워크상 최종 목적지까지 정확하게 연결되도록 연결성을 제공한다.

 

프로토콜 종류: IP, ARP, RARP, ICMP

 

**굵게** 3. 전송 계층

프로토콜 종류: TCP, UDP

 

*전송계층이 수행하는 기능은 TCP, UDP를 나누어 추후에 정리할예정.

 

**굵게** 4. 애플리케이션 계층

OSI 7계층의 세션,표현,응용 계층에 해당

사용자를 위한 UI 인터페이스 소프트웨어, 입출력 부분 등을 담당한다.

 

프로토콜 종류: FTP, HTTP, SSH, SMTP, DNS 

 

*DNS에 대해서 따로 다룰예정.


**굵게** 애플리케이션 계층을 처리하는 기기: L7 스위치


L7스위치는 로드밸런서라고도 한다.


**굵게** 로드밸런싱
말 그대로, 부하(load)를 분산(balancing)시키는 기술이다.

*기울기* 왜 필요할까?
하나의 인터넷 서비스를 이용하는 client가 한두명이라면 서버는 여유롭게 사용자가 원하는 결과를 응답할수있으나, 천만명의 client가 요청을 보낸다면??

서버는 좋은 퍼포먼스를 내기 어려울 것이다.

문제를 해결하는 방법에는
  - scale-up  : 하드웨어 성능을 올리는 기법
  - scale-out : 여러대의 서버를 추가하여 확장하는 기법. 
    (scale-out 방식으로 인프라를 증설하기로 하였다면, Load Balancing이 필요하다.)


다시 돌아와서, 로드밸런서는 이러한 로드밸런싱 기술을 제공하는 장치이다.
 
클라이언트와 애플리케이션 서버들 사이에 위치한다.

로드밸런서를 두어 대용량 트래픽을 분산시킨다면 서버는 최적의 퍼포먼스를 지속할 수 있고, 사용자에게 무중단 서비스를 제공할 수 있다.

**굵게** 로드밸런서의 역할
 - 인터넷에서 들어오는 트래픽을 가로채 어느 서버로 갈것인지 결정한다.(특정 서버의 부하를 덜어줌)
 - 서비스 중단 없이, 애플리케이션 서버들과 통신하여 서버를 추가할지 뺄지 결정한다. (유연성 제공)
 - Active한 서버에만 요청을 전송한다.(높은 가용성, 신뢰성)


**굵게** 로드밸런서의 기능
 - Health check : 서버들의 상태확인을 위해 주기적으로 서버에 요청 보냄. (L4체크는 TCP의 3-way handshaking을 통해, L7체크는 실제 웹페이지와 통신시도를 통해)
 - Tunneling : 데이터를 캡슐화하여 연결된 노드만 그 캡슐화된 패킷을 해제하여 볼 수 있게 함.
 - NAT : 사설 네트워크에서 사용하던 IP주소를 로드밸런서의 공인 IP주소로 변경.(반대과정도 포함)
 - DSR : 서버에서 클라이언트로 되돌아 갈때, 로드밸런서 거치지 않고 다이렉트로 가는 방식


로드밸런싱 알고리즘으로는
 Round Robin, Weighted Round Robin, IP Hash, Least Connection, Least Response Time 등이 있다.


