# CH 2.3 네트워크 기기

> 97 page


## TCP/IP 4계층 모델
OSI계층이 좀더 학문적인 느낌이라면, OSI 이론을 실제로 실무에서 사용하는 인터넷 표준이 TCP/IP 4계층이다.

 

*기울임* 계층을 나누는 이유?

통신이 일어나는 과정을 단계별로 파악하기 용이하여, 특정 계층에서 장애 발생하더라도 다른 계층의 장비나 소프트웨어를 건들이는 헛수고를 안할수 있다는 장점.

 

**굵게** TCP/IP 프로토콜

상위 계층 TCP : 메시지나 파일을 좀 더 작은 패킷으로 나누어 전송하고, 받은 패킷은 원래의 메시지로 조립하는 일 담당.

하위 계층 IP : 각 패킷의 주소부분을 처리하여 패킷들이 목적지에 정확하게 도달할 수 있도록함.

 

**굵게** 1. 네트워크 인터페이스 계층

OSI7계층의 물리계층과 데이터링크계층에 해당.

실제로 TCP/IP 패킷을 주고받는 계층이다. 

 

통신시 MAC주소를 사용하며,

수행하는 기능으로는 에러 검출, 패킷의 프레임화 등이 있다.

자세한 특징은 아래 OSI 7계층의 물리,데이터링크 계층에서 각각 설명.

 

프로토콜 종류: Ethernet 등이 있다.

 

**굵게** 2. 인터넷 계층

가장 중요한 기능은 Routing(경로설정: 데이터를 목적지까지 가장 안전하고 빠르게 전달하는 기능)

그외에도 Addressing(IP주소부여), packaging 이 있다.

 

네트워크상 최종 목적지까지 정확하게 연결되도록 연결성을 제공한다.

 

프로토콜 종류: IP, ARP, RARP, ICMP

 

**굵게** 3. 전송 계층

프로토콜 종류: TCP, UDP

 

*전송계층이 수행하는 기능은 TCP, UDP를 나누어 추후에 정리할예정.

 

**굵게** 4. 애플리케이션 계층

OSI 7계층의 세션,표현,응용 계층에 해당

사용자를 위한 UI 인터페이스 소프트웨어, 입출력 부분 등을 담당한다.

 

프로토콜 종류: FTP, HTTP, SSH, SMTP, DNS 

 

*DNS에 대해서 따로 다룰예정.


**굵게** 애플리케이션 계층을 처리하는 기기: L7 스위치


L7스위치는 로드밸런서라고도 한다.


**굵게** 로드밸런싱
말 그대로, 부하(load)를 분산(balancing)시키는 기술이다.

*기울기* 왜 필요할까?
하나의 인터넷 서비스를 이용하는 client가 한두명이라면 서버는 여유롭게 사용자가 원하는 결과를 응답할수있으나, 천만명의 client가 요청을 보낸다면??

서버는 좋은 퍼포먼스를 내기 어려울 것이다.

문제를 해결하는 방법에는
  - scale-up  : 하드웨어 성능을 올리는 기법
  - scale-out : 여러대의 서버를 추가하여 확장하는 기법. 
    (scale-out 방식으로 인프라를 증설하기로 하였다면, Load Balancing이 필요하다.)


다시 돌아와서, 로드밸런서는 이러한 로드밸런싱 기술을 제공하는 장치이다.
 
클라이언트와 애플리케이션 서버들 사이에 위치한다.

로드밸런서를 두어 대용량 트래픽을 분산시킨다면 서버는 최적의 퍼포먼스를 지속할 수 있고, 사용자에게 무중단 서비스를 제공할 수 있다.

**굵게** 로드밸런서의 역할
 - 인터넷에서 들어오는 트래픽을 가로채 어느 서버로 갈것인지 결정한다.(특정 서버의 부하를 덜어줌)
 - 서비스 중단 없이, 애플리케이션 서버들과 통신하여 서버를 추가할지 뺄지 결정한다. (유연성 제공)
 - Active한 서버에만 요청을 전송한다.(높은 가용성, 신뢰성)


**굵게** 로드밸런서의 기능
 - Health check : 서버들의 상태확인을 위해 주기적으로 서버에 요청 보냄. (L4체크는 TCP의 3-way handshaking을 통해, L7체크는 실제 웹페이지와 통신시도를 통해)
 - Tunneling : 데이터를 캡슐화하여 연결된 노드만 그 캡슐화된 패킷을 해제하여 볼 수 있게 함.
 - NAT : 사설 네트워크에서 사용하던 IP주소를 로드밸런서의 공인 IP주소로 변경.(반대과정도 포함)
 - DSR : 서버에서 클라이언트로 되돌아 갈때, 로드밸런서 거치지 않고 다이렉트로 가는 방식


로드밸런싱 알고리즘으로는
 Round Robin, Weighted Round Robin, IP Hash, Least Connection, Least Response Time 등이 있다.




## OSI 7계층 모델
 

**굵게** 1. 물리 계층 (단위: 비트)

  컴퓨터와 네트워크 장비를 연결하고 장치간 전송되는 데이터를 전기 신호로 변환( 비트->전기신호, 전기신호->비트)

  유선과 무선이 있으며 , 유선이 일반적이다.

  흔히 쓰이는 UTP케이블을 예로 들수있음.

 

대표적인 장비로는 랜카드, 리피터, AP, 허브 등이 있다.

-NIC: 0과 1만으로 이루어진 비트열을 랜카드로 전송하여 전기 신호로 변환(데이터 송수신)
 유선 랜카드, 무선 랜카드 있음.

-리피터: 약해진 신호를 증폭하여 다른쪽으로 전달.
먼 거리에 신호가 가야할때, 중간에 리피터 배치하여 중계하도록 할때 쓰임

-AP(Access Point): 무선 기기들은 AP에게 무선신호를 전송하고, AP는 해당 신호를 유선신호로 변환하여 네트워크에 전달. 즉, 유선네트워크와 무선네트워크를 연결하는 역할을 한다.


2.4Ghz/5Ghz의 무선신호가 저절로 utp cable 구리동선으로 들어가서 신호가 변환이 되어 갈 수는 없으므로.


* 그렇다면 핸드폰에서 WIFI접속하여 '네이버주소'를 입력하면?

--> 휴대폰이 검색명령을 무선신호로 AP에게 전송한다.

AP는 해당 신호를 유선신호로 변환하여 유선네트워크로 전달하고, 유선네트워크에서 검색결과를 받아 무선신호로 변환하여 다시 휴대폰에 전송함.  

 

**굵게** 2. 데이터링크 계층 (단위: 프레임)

'직접 연결된' 서로 다른 2개의 네트워크 장치간 데이터전송을 담당. 

데이터 링크 계층에서는 말 그대로 직접 연결된 장치와 통신만 생각한다. 그 외의 통신관련 문제는 해당 계층에서는 고려x

즉, 물리 계층에서 사용되는 장비를 이용하여 호스트 사이의 연결 및 데이터 전송 기능과 관리를 하는 계층이다.

 

MAC Address 가지고 통신

우리가 흔히 아는 ip주소간의 통신은 이 MAC주소의 통신의 연속된 과정이라고 볼수있다.

MAC주소는 컴퓨터나 노트북에 있는 LAN카드를 구별하기 위한 식별번호라고 한다.(물리적 주소)

 

수행하는 서비스로는

- 프레이밍 : 데이터 배열에 Data, Header, Trailer 등을 넣어서 캡슐화(Encapsulate) 진행 

- 흐름제어 : 송신자와 수신자의 처리 속도간의 차이를 해결하기 위한 제어. (송신 측이 수신 측의 데이터 처리속도보다 빠른 속도로 데이터를 보낸다면 버퍼가 길어질 것이며, 버퍼의 길이는 제한되어있으므로)

- 에러확인 : 에러를 검출하는 방법에는 직접 수정하는 방법과 수신받은 데이터배열을 폐기하고 송신측에 데이터를 재요청 하는 방법이 있다.

 

이더넷 프레임을 통해 에러확인, 흐름제어, 접근제어 등을 수행

 

대표 장비로 브리지, 스위치가 있음.

-스위치: 장치들의 MAC주소를 맥 주소 테이블로 관리. 패킷 전송을 담당.

-브리지: 두개의 LAN을 상호 접속 할수있도록 연결.
 포트와 포트 사이의 다리 역할.

 

**굵게** 3. 네트워크 계층 (단위: 패킷)

원하는 곳으로 잘보내고 있는지, 효율적인 방법으로 보내는지 어떻게 보장하느냐? -->이거를 네트워크 계층이 담당한다.

 

ip주소는 데이터 통신시의 시작점과 끝점을 의미,

MAC주소는 직접적으로 연결된 노드와 통신할때 사용되는 주소.

 

프로토콜 종류 : IP, ARP, RARP

 

라우터: 일종의 지능이 있는 경로 배정기

공유기 : 2개의 서로 다른 네트워크를 연결.


공인 ip주소를받아서 연결되는 실제 네트워크와 가상으로 192.168.x.x 주소를 부여하는 사설 네트워크(LAN)를 연결시켜서 사설 네트워크에 연결된 pc가 실제 인터넷에 연결되게 한다.

일종의 NAT기능 DHCP기능 추가된 라우터

무선공유기: 유선공유기+ap느낌 (ap는 nat기능 없음)



**굵게** 4. 전송 계층 (단위: 세그먼트(TCP), 데이터그램(UDP))

**굵게** 5. 세션 계층

**굵게** 6. 표현 계층

**굵게** 7. 애플리케이션 계층
